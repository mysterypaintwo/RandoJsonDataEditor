<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Super Metroid: X-Fusion - Room Properties Editor</title>
    <link rel="stylesheet" href="../editorStyles.css">
  </head>
  <body>
    <!-- =======================================================
		     Header: Location Context Display
		     Shows current sector/region/room being edited
		     ======================================================= -->
    <div id="header">
      ğŸŒ <span id="sector">Loading...</span> / <span id="region">Loading...</span> / <span id="roomName">Loading...</span>
    </div>

    <!-- =======================================================
		     Room Metadata: Read-only Properties
		     Displays room-level metadata
		     ======================================================= -->
    <div id="roomMetadata" style="background: #f8f9fa; padding: 12px; border-bottom: 2px solid #dee2e6;">
      <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 8px; font-size: 13px;">
        <div><strong>Room Address:</strong> <span id="roomAddress">-</span></div>
        <div><strong>Room Image:</strong> <span id="roomImageFile">-</span></div>
        <div><strong>Next Strat ID:</strong> <span id="nextStratId">-</span></div>
        <div><strong>Next Notable ID:</strong> <span id="nextNotableId">-</span></div>
      </div>
    </div>

    <!-- =======================================================
		     Main Content Area
		     Contains all editor sections and controls
		     ======================================================= -->
    <div id="form">
      <div id="formContent">
      <!-- Obstacles Section -->
      <section>
        <h3>ğŸª¨ Obstacles</h3>
        <div id="obstaclesContainer" class="editor-container"></div>
        <button id="addObstaclesBtn" class="add-btn">+ Add Obstacle</button>
      </section>

      <!-- Enemies Section -->
      <section>
        <h3>ğŸ‘¾ Enemies</h3>
        <div id="enemiesContainer" class="editor-container"></div>
        <button id="addEnemiesBtn" class="add-btn">+ Add Enemy</button>
      </section>

      <!-- Strats Section -->
      <section>
        <h3>ğŸ“˜ Strats</h3>
        <div id="stratsContainer" class="editor-container"></div>
        <button id="addStratsBtn" class="add-btn">+ Add Strat</button>
      </section>

      <!-- Notable Strats Section -->
      <section>
        <h3>â­ Notable Strats</h3>
        <div id="notablesContainer" class="editor-container"></div>
        <button id="addNotablesBtn" class="add-btn">+ Add Notable</button>
      </section>

      <!-- Nodes Section -->
      <section>
        <h3>ğŸ”€ Junction Nodes (Draw in main window)</h3>
        <div id="nodesContainer" class="editor-container"></div>
      </section>

      <!-- Visual Break -->
      <hr style="margin: 32px 0; border: none; border-top: 3px solid #dee2e6;">

      <!-- Room Environments Section -->
      <section>
        <h3>ğŸŒ¡ï¸ Room Environments</h3>
        <p style="font-size: 13px; color: #666; margin-bottom: 12px;">
          Define environmental conditions for this room. Most rooms have one environment that's always active.
        </p>
        <div id="roomEnvironmentsContainer" class="editor-container"></div>
        <button id="addRoomEnvironmentBtn" class="add-btn">+ Add Environment</button>
      </section>

      <!-- Map Tile Mask Section -->
      <section>
        <h3>ğŸ—ºï¸ Map Tile Mask</h3>
        <p style="font-size: 13px; color: #666; margin-bottom: 12px;">
          Define which tiles are accessible in normal ways (blue = accessible, gray = inaccessible).
        </p>
        <div id="mapTileMaskContainer"></div>
      </section>

      <!-- Room Notes Section -->
      <section id="roomNotesSection">
        <h3>ğŸ“ Room Notes</h3>
        <div style="margin-bottom: 16px;">
          <label style="display: block; font-weight: 600; margin-bottom: 6px;">Note:</label>
          <textarea id="roomNote" rows="3" placeholder="Optional note about this room..." style="width: 100%; box-sizing: border-box; padding: 8px; border: 1px solid #ccc; border-radius: 4px; font-family: inherit; font-size: 14px;"></textarea>
        </div>
        <div>
          <label style="display: block; font-weight: 600; margin-bottom: 6px;">Dev Note:</label>
          <textarea id="roomDevNote" rows="3" placeholder="Optional developer note about this room..." style="width: 100%; box-sizing: border-box; padding: 8px; border: 1px solid #ccc; border-radius: 4px; font-family: inherit; font-size: 14px;"></textarea>
        </div>
      </section>
      </div>
    </div>
    
    <!-- =======================================================
		     Footer: Action Buttons
		     Save/Cancel operations
		     ======================================================= -->
    <div id="footer">
      <button id="closeBtn" class="secondary-btn">âŒ Close without Saving</button>
      <button id="saveBtn" class="primary-btn">ğŸ’¾ Save & Close</button>
    </div>

    <!-- =======================================================
		     Script Dependencies - Updated modular structure
		     Load in order: config, utilities, condition system, editors, main
		     ======================================================= -->
    <!-- Base classes first -->
    <script src="../base/baseEditor.js"></script>

    <!-- Utility functions -->
    <script src="../../core/editorUtils.js"></script>

    <!-- TileMap Editor Component -->
    <script src="../../core/tilemapEditor.js"></script>

    <!-- New modular condition system -->
    <script src="../conditions/conditionConfig.js"></script>
    <script src="../conditions/sharedUtils.js"></script>
    <script src="../conditions/conditionRenderers.js"></script>
    <script src="../conditions/conditionEditorBase.js"></script>

    <!-- Specific editor classes -->
    <script src="../entrance/entranceEditor.js"></script>
    <script src="../exit/exitEditor.js"></script>
    <script src="../obstacles/obstacleEditor.js"></script>
    <script src="../enemies/enemyEditor.js"></script>
    <script src="../strats/stratEditor.js"></script>
    <script src="../notables/notableEditor.js"></script>
    <script src="../junctionNodes/junctionNodesEditor.js"></script>
    <script src="./roomEnvironmentEditor.js"></script>

    <!-- Main controller -->
    <script src="./roomPropertiesEditor.js"></script>
  </body>
</html>